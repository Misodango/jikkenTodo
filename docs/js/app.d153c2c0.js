(function(){"use strict";var e={6341:function(e,t,l){var a=l(5130),o=l(6768);const n={id:"app"};function s(e,t,l,a,s,r){const i=(0,o.g2)("router-view");return(0,o.uX)(),(0,o.CE)("div",n,[(0,o.bF)(i)])}var r={name:"App"},i=l(1241);const d=(0,i.A)(r,[["render",s]]);var u=d,c=l(1387);function p(e,t,l,a,n,s){const r=(0,o.g2)("v-card-title"),i=(0,o.g2)("v-icon"),d=(0,o.g2)("v-btn"),u=(0,o.g2)("v-card-text"),c=(0,o.g2)("v-card"),p=(0,o.g2)("v-col"),m=(0,o.g2)("v-row"),v=(0,o.g2)("v-container");return(0,o.uX)(),(0,o.Wv)(v,{class:"fill-height position-relative",fluid:""},{default:(0,o.k6)((()=>[(0,o.bF)(m,{align:"start",justify:"center",class:"mt-16"},{default:(0,o.k6)((()=>[(0,o.bF)(p,{cols:"12",sm:"8",md:"4"},{default:(0,o.k6)((()=>[(0,o.bF)(c,{class:"elevation-0 rounded-lg",style:{background:"rgba(255, 255, 255, 0.95)"}},{default:(0,o.k6)((()=>[(0,o.bF)(r,{class:"text-h4 font-weight-bold text-center py-6",style:{"font-family":"'Noto Sans JP', sans-serif"}},{default:(0,o.k6)((()=>t[0]||(t[0]=[(0,o.eW)(" ExperiMentor "),(0,o.Lk)("div",{class:"text-subtitle-1 mt-2 text-grey-darken-1"},"実験をもっとスマートに",-1)]))),_:1}),(0,o.bF)(u,{class:"pa-6"},{default:(0,o.k6)((()=>[(0,o.bF)(d,{onClick:s.login,color:"primary",block:"",class:"mb-4 py-6 text-body-1 font-weight-medium",elevation:"2",rounded:"lg"},{default:(0,o.k6)((()=>[(0,o.bF)(i,{start:"",icon:"mdi-login",class:"mr-2"}),t[1]||(t[1]=(0,o.eW)(" ログイン "))])),_:1},8,["onClick"]),(0,o.bF)(d,{onClick:s.signup,variant:"outlined",block:"",class:"py-6 text-body-1 font-weight-medium",elevation:"0",rounded:"lg"},{default:(0,o.k6)((()=>[(0,o.bF)(i,{start:"",icon:"mdi-account-plus",class:"mr-2"}),t[2]||(t[2]=(0,o.eW)(" アカウント作成 "))])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1}),t[3]||(t[3]=(0,o.Lk)("div",{class:"lab-scene"},[(0,o.Lk)("div",{class:"float-element beaker"},[(0,o.Lk)("svg",{viewBox:"0 0 100 100",width:"80",height:"80"},[(0,o.Lk)("path",{d:"M30,20 L30,70 C30,85 70,85 70,70 L70,20 L30,20 Z",fill:"none",stroke:"currentColor","stroke-width":"3"}),(0,o.Lk)("path",{d:"M25,20 L75,20",stroke:"currentColor","stroke-width":"3"}),(0,o.Lk)("path",{class:"liquid",d:"M30,45 L30,70 C30,85 70,85 70,70 L70,45 Z",fill:"currentColor"})])]),(0,o.Lk)("div",{class:"float-element flask"},[(0,o.Lk)("svg",{viewBox:"0 0 100 100",width:"60",height:"60"},[(0,o.Lk)("path",{d:"M50,10 L50,40 L30,80 C25,90 75,90 70,80 L50,40",fill:"none",stroke:"currentColor","stroke-width":"3"}),(0,o.Lk)("path",{class:"liquid",d:"M30,80 C25,90 75,90 70,80 L50,60 L30,80",fill:"currentColor"})])]),(0,o.Lk)("div",{class:"float-element molecule"},[(0,o.Lk)("svg",{viewBox:"0 0 100 100",width:"40",height:"40"},[(0,o.Lk)("circle",{cx:"50",cy:"50",r:"10",fill:"currentColor"}),(0,o.Lk)("circle",{cx:"80",cy:"50",r:"10",fill:"currentColor"}),(0,o.Lk)("circle",{cx:"50",cy:"80",r:"10",fill:"currentColor"}),(0,o.Lk)("line",{x1:"50",y1:"50",x2:"80",y2:"50",stroke:"currentColor","stroke-width":"3"}),(0,o.Lk)("line",{x1:"50",y1:"50",x2:"50",y2:"80",stroke:"currentColor","stroke-width":"3"})])])],-1))])),_:1})}l(4114);var m={name:"StartScreen",methods:{login(){this.$router.push("/login")},signup(){this.$router.push("/signup")}}};const v=(0,i.A)(m,[["render",p],["__scopeId","data-v-485fff6a"]]);var k=v,f=l(4232);function b(e,t,l,n,s,r){const i=(0,o.g2)("v-card-title"),d=(0,o.g2)("v-text-field"),u=(0,o.g2)("v-btn"),c=(0,o.g2)("v-form"),p=(0,o.g2)("v-card-text"),m=(0,o.g2)("v-alert"),v=(0,o.g2)("v-card"),k=(0,o.g2)("v-col"),b=(0,o.g2)("v-row"),g=(0,o.g2)("v-container");return(0,o.uX)(),(0,o.Wv)(g,{class:"fill-height position-relative",fluid:""},{default:(0,o.k6)((()=>[(0,o.bF)(b,{justify:"center",align:"center"},{default:(0,o.k6)((()=>[(0,o.bF)(k,{cols:"12",sm:"8",md:"6",lg:"4"},{default:(0,o.k6)((()=>[(0,o.bF)(v,{class:"elevation-12 pa-4"},{default:(0,o.k6)((()=>[(0,o.bF)(i,{class:"text-center text-h4 font-weight-bold"},{default:(0,o.k6)((()=>t[4]||(t[4]=[(0,o.eW)(" Login ")]))),_:1}),(0,o.bF)(p,null,{default:(0,o.k6)((()=>[(0,o.bF)(c,{onSubmit:(0,a.D$)(r.handleLogin,["prevent"]),modelValue:s.valid,"onUpdate:modelValue":t[3]||(t[3]=e=>s.valid=e)},{default:(0,o.k6)((()=>[(0,o.bF)(d,{modelValue:s.email,"onUpdate:modelValue":t[0]||(t[0]=e=>s.email=e),label:"Email",type:"email",rules:s.emailRules,required:"","prepend-icon":"mdi-email",variant:"outlined",class:"mb-2"},null,8,["modelValue","rules"]),(0,o.bF)(d,{modelValue:s.password,"onUpdate:modelValue":t[1]||(t[1]=e=>s.password=e),label:"Password",type:s.showPassword?"text":"password",rules:s.passwordRules,required:"","prepend-icon":"mdi-lock","append-icon":s.showPassword?"mdi-eye-off":"mdi-eye","onClick:append":t[2]||(t[2]=e=>s.showPassword=!s.showPassword),variant:"outlined",class:"mb-4"},null,8,["modelValue","type","rules","append-icon"]),(0,o.bF)(u,{type:"submit",color:"primary",block:"",loading:s.loading,disabled:!s.valid||s.loading,size:"large"},{default:(0,o.k6)((()=>t[5]||(t[5]=[(0,o.eW)(" Login ")]))),_:1},8,["loading","disabled"])])),_:1},8,["onSubmit","modelValue"])])),_:1}),s.message?((0,o.uX)(),(0,o.Wv)(m,{key:0,type:s.message.includes("successful")?"success":"error",class:"mt-4"},{default:(0,o.k6)((()=>[(0,o.eW)((0,f.v_)(s.message),1)])),_:1},8,["type"])):(0,o.Q3)("",!0),(0,o.bF)(p,{class:"text-center mt-4"},{default:(0,o.k6)((()=>[t[7]||(t[7]=(0,o.eW)(" アカウントを持っていませんか? ")),(0,o.bF)(u,{variant:"text",color:"primary",to:"/signup"},{default:(0,o.k6)((()=>t[6]||(t[6]=[(0,o.eW)(" サインアップはこちら ")]))),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),t[8]||(t[8]=(0,o.Lk)("div",{class:"lab-scene"},[(0,o.Lk)("div",{class:"float-element beaker"},[(0,o.Lk)("svg",{viewBox:"0 0 100 100",width:"80",height:"80"},[(0,o.Lk)("path",{d:"M30,20 L30,70 C30,85 70,85 70,70 L70,20 L30,20 Z",fill:"none",stroke:"currentColor","stroke-width":"3"}),(0,o.Lk)("path",{d:"M25,20 L75,20",stroke:"currentColor","stroke-width":"3"}),(0,o.Lk)("path",{class:"liquid",d:"M30,45 L30,70 C30,85 70,85 70,70 L70,45 Z",fill:"currentColor"})])]),(0,o.Lk)("div",{class:"float-element flask"},[(0,o.Lk)("svg",{viewBox:"0 0 100 100",width:"60",height:"60"},[(0,o.Lk)("path",{d:"M50,10 L50,40 L30,80 C25,90 75,90 70,80 L50,40",fill:"none",stroke:"currentColor","stroke-width":"3"}),(0,o.Lk)("path",{class:"liquid",d:"M30,80 C25,90 75,90 70,80 L50,60 L30,80",fill:"currentColor"})])]),(0,o.Lk)("div",{class:"float-element molecule"},[(0,o.Lk)("svg",{viewBox:"0 0 100 100",width:"40",height:"40"},[(0,o.Lk)("circle",{cx:"50",cy:"50",r:"10",fill:"currentColor"}),(0,o.Lk)("circle",{cx:"80",cy:"50",r:"10",fill:"currentColor"}),(0,o.Lk)("circle",{cx:"50",cy:"80",r:"10",fill:"currentColor"}),(0,o.Lk)("line",{x1:"50",y1:"50",x2:"80",y2:"50",stroke:"currentColor","stroke-width":"3"}),(0,o.Lk)("line",{x1:"50",y1:"50",x2:"50",y2:"80",stroke:"currentColor","stroke-width":"3"})])])],-1))])),_:1})}var g=l(6400),h=l(7617),_=l(7307),F=l(7844);const x={apiKey:"AIzaSyBHuYgEu5di4FUJmPsrA0EB_7j0VN-xUCk",authDomain:"jikkentodoapp.firebaseapp.com",projectId:"jikkentodoapp",storageBucket:"jikkentodoapp.firebasestorage.app",messagingSenderId:"44572662255",appId:"1:44572662255:web:d69ac54c0b27ed441d3e1a"},w=(0,g.Wp)(x),y=(0,h.aU)(w),C=(0,_.xI)(w);(0,F.c7)(w),(0,h.aU)(w);var V={data(){return{valid:!1,loading:!1,email:"",password:"",message:"",showPassword:!1,emailRules:[e=>!!e||"Email is required",e=>/.+@.+\..+/.test(e)||"Email must be valid"],passwordRules:[e=>!!e||"Password is required",e=>e.length>=6||"Password must be at least 6 characters"]}},methods:{async handleLogin(){if(this.valid){this.loading=!0,this.message="";try{await(0,_.x9)(C,this.email,this.password),this.message="Login successful!",this.$router.push("/dashboard")}catch(e){this.message=e.message}finally{this.loading=!1}}}}};const W=(0,i.A)(V,[["render",b],["__scopeId","data-v-2a3288f9"]]);var L=W;function E(e,t,l,n,s,r){const i=(0,o.g2)("v-card-title"),d=(0,o.g2)("v-text-field"),u=(0,o.g2)("v-btn"),c=(0,o.g2)("v-form"),p=(0,o.g2)("v-card-text"),m=(0,o.g2)("v-alert"),v=(0,o.g2)("v-card"),k=(0,o.g2)("v-col"),b=(0,o.g2)("v-row"),g=(0,o.g2)("v-container");return(0,o.uX)(),(0,o.Wv)(g,{class:"fill-height position-relative",fluid:""},{default:(0,o.k6)((()=>[(0,o.bF)(b,{justify:"center",align:"center"},{default:(0,o.k6)((()=>[(0,o.bF)(k,{cols:"12",sm:"8",md:"6",lg:"4"},{default:(0,o.k6)((()=>[(0,o.bF)(v,{class:"elevation-12 pa-4"},{default:(0,o.k6)((()=>[(0,o.bF)(i,{class:"text-center text-h4 font-weight-bold"},{default:(0,o.k6)((()=>t[7]||(t[7]=[(0,o.eW)(" サインアップ ")]))),_:1}),(0,o.bF)(p,null,{default:(0,o.k6)((()=>[(0,o.bF)(c,{onSubmit:(0,a.D$)(r.handleSignup,["prevent"]),modelValue:s.valid,"onUpdate:modelValue":t[6]||(t[6]=e=>s.valid=e)},{default:(0,o.k6)((()=>[(0,o.bF)(d,{modelValue:s.email,"onUpdate:modelValue":t[0]||(t[0]=e=>s.email=e),label:"Email",type:"email",rules:s.emailRules,required:"","prepend-icon":"mdi-email",variant:"outlined",class:"mb-2"},null,8,["modelValue","rules"]),(0,o.bF)(d,{modelValue:s.displayName,"onUpdate:modelValue":t[1]||(t[1]=e=>s.displayName=e),label:"表示名","prepend-icon":"mdi-rename",variant:"outlined",rules:s.displayNameRules,required:"",class:"mb-2"},null,8,["modelValue","rules"]),(0,o.bF)(d,{modelValue:s.password,"onUpdate:modelValue":t[2]||(t[2]=e=>s.password=e),label:"Password",type:s.showPassword?"text":"password",rules:s.passwordRules,required:"","prepend-icon":"mdi-lock","append-icon":s.showPassword?"mdi-eye-off":"mdi-eye","onClick:append":t[3]||(t[3]=e=>s.showPassword=!s.showPassword),variant:"outlined",class:"mb-4"},null,8,["modelValue","type","rules","append-icon"]),(0,o.bF)(d,{modelValue:s.confirmPassword,"onUpdate:modelValue":t[4]||(t[4]=e=>s.confirmPassword=e),label:"Confirm Password",type:s.showConfirmPassword?"text":"password",rules:s.confirmPasswordRules,required:"","prepend-icon":"mdi-lock-check","append-icon":s.showConfirmPassword?"mdi-eye-off":"mdi-eye","onClick:append":t[5]||(t[5]=e=>s.showConfirmPassword=!s.showConfirmPassword),variant:"outlined",class:"mb-4"},null,8,["modelValue","type","rules","append-icon"]),(0,o.bF)(u,{type:"submit",color:"primary",block:"",loading:s.loading,disabled:!s.valid||s.loading,size:"large"},{default:(0,o.k6)((()=>t[8]||(t[8]=[(0,o.eW)(" 登録 ")]))),_:1},8,["loading","disabled"])])),_:1},8,["onSubmit","modelValue"])])),_:1}),s.message?((0,o.uX)(),(0,o.Wv)(m,{key:0,type:s.message.includes("successful")?"success":"error",class:"mt-4"},{default:(0,o.k6)((()=>[(0,o.eW)((0,f.v_)(s.message),1)])),_:1},8,["type"])):(0,o.Q3)("",!0),(0,o.bF)(p,{class:"text-center mt-4"},{default:(0,o.k6)((()=>[t[10]||(t[10]=(0,o.eW)(" すでにアカウントをお持ちですか？ ")),(0,o.bF)(u,{variant:"text",color:"primary",to:"/login"},{default:(0,o.k6)((()=>t[9]||(t[9]=[(0,o.eW)(" ログインはこちら ")]))),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),t[11]||(t[11]=(0,o.Lk)("div",{class:"lab-scene"},[(0,o.Lk)("div",{class:"float-element beaker"},[(0,o.Lk)("svg",{viewBox:"0 0 100 100",width:"80",height:"80"},[(0,o.Lk)("path",{d:"M30,20 L30,70 C30,85 70,85 70,70 L70,20 L30,20 Z",fill:"none",stroke:"currentColor","stroke-width":"3"}),(0,o.Lk)("path",{d:"M25,20 L75,20",stroke:"currentColor","stroke-width":"3"}),(0,o.Lk)("path",{class:"liquid",d:"M30,45 L30,70 C30,85 70,85 70,70 L70,45 Z",fill:"currentColor"})])]),(0,o.Lk)("div",{class:"float-element flask"},[(0,o.Lk)("svg",{viewBox:"0 0 100 100",width:"60",height:"60"},[(0,o.Lk)("path",{d:"M50,10 L50,40 L30,80 C25,90 75,90 70,80 L50,40",fill:"none",stroke:"currentColor","stroke-width":"3"}),(0,o.Lk)("path",{class:"liquid",d:"M30,80 C25,90 75,90 70,80 L50,60 L30,80",fill:"currentColor"})])]),(0,o.Lk)("div",{class:"float-element molecule"},[(0,o.Lk)("svg",{viewBox:"0 0 100 100",width:"40",height:"40"},[(0,o.Lk)("circle",{cx:"50",cy:"50",r:"10",fill:"currentColor"}),(0,o.Lk)("circle",{cx:"80",cy:"50",r:"10",fill:"currentColor"}),(0,o.Lk)("circle",{cx:"50",cy:"80",r:"10",fill:"currentColor"}),(0,o.Lk)("line",{x1:"50",y1:"50",x2:"80",y2:"50",stroke:"currentColor","stroke-width":"3"}),(0,o.Lk)("line",{x1:"50",y1:"50",x2:"50",y2:"80",stroke:"currentColor","stroke-width":"3"})])])],-1))])),_:1})}var S={data(){return{valid:!1,loading:!1,email:"",password:"",confirmPassword:"",displayName:"",message:"",showPassword:!1,showConfirmPassword:!1,emailRules:[e=>!!e||"メールアドレスを入力してください.",e=>/.+@.+\..+/.test(e)||"有効なメールアドレスを入力してください."],passwordRules:[e=>!!e||"パスワードを入力してください.",e=>e.length>=6||"パスワードは最低6文字です."],confirmPasswordRules:[e=>!!e||"パスワードを確認してください.",e=>e===this.password||"パスワードが一致しません."],displayNameRules:[e=>!!e||"表示名を入力してください.",e=>e.length<=15||"表示名は15文字以下にしてください"]}},methods:{async handleSignup(){if(this.valid){this.loading=!0,this.message="";try{const t=await(0,_.eJ)(C,this.email,this.password);try{await(0,_.r7)(t.user,{displayName:this.displayName})}catch(e){this.message("ユーザー名を登録できませんでした.")}this.message="登録が完了しました!",this.$router.push("/login")}catch(e){this.message=e.message}finally{this.loading=!1}}}}};const D=(0,i.A)(S,[["render",E],["__scopeId","data-v-1722bcf0"]]);var P=D;l(8992),l(4520);const U={class:"pa-4"},R={class:"text-truncate"};function X(e,t,l,a,n,s){const r=(0,o.g2)("v-icon"),i=(0,o.g2)("v-card-title"),d=(0,o.g2)("v-card"),u=(0,o.g2)("v-col"),c=(0,o.g2)("v-row"),p=(0,o.g2)("v-select"),m=(0,o.g2)("v-text-field"),v=(0,o.g2)("v-card-subtitle"),k=(0,o.g2)("v-card-item"),b=(0,o.g2)("v-chip"),g=(0,o.g2)("v-card-text"),h=(0,o.g2)("v-spacer"),_=(0,o.g2)("v-btn"),F=(0,o.g2)("v-card-actions"),x=(0,o.g2)("v-alert"),w=(0,o.g2)("v-container");return(0,o.uX)(),(0,o.Wv)(w,{fluid:""},{default:(0,o.k6)((()=>[(0,o.bF)(c,{class:"mb-6"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{cols:"12"},{default:(0,o.k6)((()=>[(0,o.bF)(d,null,{default:(0,o.k6)((()=>[(0,o.bF)(i,{class:"text-h5 d-flex align-center"},{default:(0,o.k6)((()=>[(0,o.bF)(r,{start:"",class:"me-2"},{default:(0,o.k6)((()=>t[4]||(t[4]=[(0,o.eW)("mdi-view-dashboard")]))),_:1}),t[5]||(t[5]=(0,o.eW)(" 実験一覧 "))])),_:1})])),_:1})])),_:1})])),_:1}),(0,o.bF)(c,{class:"mb-4"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{cols:"12",sm:"4"},{default:(0,o.k6)((()=>[(0,o.bF)(p,{modelValue:a.filter,"onUpdate:modelValue":t[0]||(t[0]=e=>a.filter=e),items:a.filterOptions,label:"ステータス","prepend-inner-icon":"mdi-filter",clearable:""},null,8,["modelValue","items"])])),_:1}),(0,o.bF)(u,{cols:"12",sm:"4"},{default:(0,o.k6)((()=>[(0,o.bF)(p,{modelValue:a.sortBy,"onUpdate:modelValue":t[1]||(t[1]=e=>a.sortBy=e),items:a.sortOptions,label:"並び替え","prepend-inner-icon":"mdi-sort"},null,8,["modelValue","items"])])),_:1}),(0,o.bF)(u,{cols:"12",sm:"4"},{default:(0,o.k6)((()=>[(0,o.bF)(m,{modelValue:a.search,"onUpdate:modelValue":t[2]||(t[2]=e=>a.search=e),label:"実験を検索","prepend-inner-icon":"mdi-magnify",clearable:""},null,8,["modelValue"])])),_:1})])),_:1}),(0,o.bF)(c,null,{default:(0,o.k6)((()=>[(0,o.bF)(u,{cols:"12"},{default:(0,o.k6)((()=>[(0,o.bF)(d,null,{default:(0,o.k6)((()=>[(0,o.Lk)("div",U,[(0,o.bF)(c,null,{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.filteredExperiments,(e=>((0,o.uX)(),(0,o.Wv)(u,{key:e.id,cols:"12",sm:"6",md:"4"},{default:(0,o.k6)((()=>[(0,o.bF)(d,{variant:"outlined",color:a.getStatusColor(e),class:(0,f.C4)(["experiment-card",{completed:"completed"===e.status}]),onClick:t=>a.navigateToExperiment(e.id)},{default:(0,o.k6)((()=>[(0,o.bF)(k,null,{prepend:(0,o.k6)((()=>[100==s.updateProgress(e)?((0,o.uX)(),(0,o.Wv)(r,{key:0,color:a.getStatusColor(e),size:"large",class:"me-2"},{default:(0,o.k6)((()=>t[6]||(t[6]=[(0,o.eW)(" mdi-check-circle ")]))),_:2},1032,["color"])):((0,o.uX)(),(0,o.Wv)(r,{key:1,color:a.getStatusColor(e),size:"large",class:"me-2"},{default:(0,o.k6)((()=>t[7]||(t[7]=[(0,o.eW)(" mdi-flask ")]))),_:2},1032,["color"]))])),default:(0,o.k6)((()=>[(0,o.bF)(i,null,{default:(0,o.k6)((()=>[(0,o.eW)((0,f.v_)(e.title),1)])),_:2},1024),(0,o.bF)(v,null,{default:(0,o.k6)((()=>[(0,o.eW)(" 予定日: "+(0,f.v_)(a.formatDate(e.date)),1)])),_:2},1024)])),_:2},1024),(0,o.bF)(g,null,{default:(0,o.k6)((()=>[(0,o.Lk)("div",R,(0,f.v_)(e.description||"説明なし"),1),(0,o.bF)(b,{class:"mt-2",color:a.getStatusColor(e),size:"small",label:""},{default:(0,o.k6)((()=>[(0,o.eW)(" 進捗："+(0,f.v_)(s.updateProgress(e))+"% ",1)])),_:2},1032,["color"])])),_:2},1024),(0,o.bF)(F,null,{default:(0,o.k6)((()=>[(0,o.bF)(h),(0,o.bF)(_,{variant:"text",color:"red",onClick:t=>a.deleteExperiment(e.id)},{default:(0,o.k6)((()=>[t[9]||(t[9]=(0,o.eW)(" 削除 ")),(0,o.bF)(r,{end:""},{default:(0,o.k6)((()=>t[8]||(t[8]=[(0,o.eW)("mdi-delete-circle")]))),_:1})])),_:2},1032,["onClick"]),(0,o.bF)(_,{variant:"text",color:"primary",to:`/experiment/${e.id}`},{default:(0,o.k6)((()=>[t[11]||(t[11]=(0,o.eW)(" 詳細を見る ")),(0,o.bF)(r,{end:""},{default:(0,o.k6)((()=>t[10]||(t[10]=[(0,o.eW)("mdi-arrow-right")]))),_:1})])),_:2},1032,["to"])])),_:2},1024)])),_:2},1032,["color","class","onClick"])])),_:2},1024)))),128))])),_:1}),0===a.filteredExperiments.length?((0,o.uX)(),(0,o.Wv)(x,{key:0,type:"info",variant:"tonal",class:"mt-4"},{default:(0,o.k6)((()=>t[12]||(t[12]=[(0,o.eW)(" 実験が見つかりません。新しい実験を登録してみましょう！ ")]))),_:1})):(0,o.Q3)("",!0)])])),_:1})])),_:1})])),_:1}),(0,o.bF)(_,{class:"floating-btn",color:"primary",icon:"mdi-pencil",size:"x-large",onClick:t[3]||(t[3]=t=>e.$router.push("/register"))})])),_:1})}l(1454);var $=l(144),K={name:"DashboardScreen",methods:{updateProgress(e){const t=e.steps.length,l=e.steps.filter((e=>e.checked)).length,a=Math.round(l/t*100);return a}},setup(){const e=(0,c.rd)(),t=(0,$.KR)([]),l=(0,$.KR)(""),a=(0,$.KR)("date"),n=(0,$.KR)(""),s=!1,r=[{title:"すべて",value:""},{title:"予定",value:"pending"},{title:"進行中",value:"inProgress"},{title:"完了",value:"completed"}],i=[{title:"日付順",value:"date"},{title:"タイトル順",value:"title"},{title:"ステータス順",value:"status"}],d=(0,o.EW)((()=>{let e=[...t.value];return n.value&&(e=e.filter((e=>e.title.toLowerCase().includes(n.value.toLowerCase())||e.description?.toLowerCase().includes(n.value.toLowerCase())))),l.value&&(e=e.filter((e=>e.status===l.value))),e.sort(((e,t)=>{switch(a.value){case"date":return new Date(e.date)-new Date(t.date);case"title":return e.title.localeCompare(t.title);case"status":return e.status.localeCompare(t.status);default:return 0}})),e})),u=async()=>{try{const e=(0,h.P)((0,h.rJ)(y,"experiments"),(0,h._M)("userId","==",C.currentUser?.displayName||"")),l=await(0,h.GG)(e);t.value=l.docs.map((e=>({id:e.id,...e.data()})))}catch(e){}},p=e=>new Date(e).toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"}),m=e=>{const t=e.steps.length,l=e.steps.filter((e=>e.checked)).length,a=Math.round(l/t*100);return 0==a?"grey":100==a?"green":"blue"},v=e=>{const t={pending:"予定",inProgress:"進行中",completed:"完了"};return t[e]||"不明"},k=t=>{e.push(`/experiment/${t}`)};(0,o.sV)((()=>{u()}));const f=async t=>{try{await(0,h.kd)((0,h.H9)(y,"experiments",t)),e.push("/dashboard")}catch(l){}};return{experiments:t,filter:l,filterOptions:r,sortBy:a,sortOptions:i,search:n,filteredExperiments:d,formatDate:p,getStatusColor:m,getStatusText:v,navigateToExperiment:k,fab:s,deleteExperiment:f}}};const I=(0,i.A)(K,[["render",X],["__scopeId","data-v-7f65e48a"]]);var j=I;function A(e,t,l,a,n,s){const r=(0,o.g2)("v-icon"),i=(0,o.g2)("v-card-title"),d=(0,o.g2)("v-text-field"),u=(0,o.g2)("v-textarea"),c=(0,o.g2)("v-file-input"),p=(0,o.g2)("ExperimentEditor"),m=(0,o.g2)("v-progress-linear"),v=(0,o.g2)("v-expansion-panel-title"),k=(0,o.g2)("v-btn"),b=(0,o.g2)("v-expansion-panel-text"),g=(0,o.g2)("v-expansion-panel"),h=(0,o.g2)("v-expansion-panels"),_=(0,o.g2)("v-row"),F=(0,o.g2)("v-form"),x=(0,o.g2)("v-card-text"),w=(0,o.g2)("v-card"),y=(0,o.g2)("v-col"),C=(0,o.g2)("v-container");return(0,o.uX)(),(0,o.Wv)(C,{fluid:""},{default:(0,o.k6)((()=>[(0,o.bF)(_,{class:"mb-6"},{default:(0,o.k6)((()=>[(0,o.bF)(y,{cols:"12"},{default:(0,o.k6)((()=>[(0,o.bF)(w,{class:"mb-4"},{default:(0,o.k6)((()=>[(0,o.bF)(i,{class:"text-h5 d-flex align-center"},{default:(0,o.k6)((()=>[(0,o.bF)(r,{start:"",class:"me-2"},{default:(0,o.k6)((()=>t[7]||(t[7]=[(0,o.eW)("mdi-file-clock-outline")]))),_:1}),t[8]||(t[8]=(0,o.eW)(" 実験スケジュールを登録 "))])),_:1}),(0,o.bF)(x,null,{default:(0,o.k6)((()=>[(0,o.bF)(F,{ref:"form",modelValue:a.valid,"onUpdate:modelValue":t[6]||(t[6]=e=>a.valid=e)},{default:(0,o.k6)((()=>[(0,o.bF)(d,{modelValue:a.experimentData.purpose,"onUpdate:modelValue":t[0]||(t[0]=e=>a.experimentData.purpose=e),label:"実験の目的",required:"",rules:[e=>!!e||"実験の目的は必須です"]},null,8,["modelValue","rules"]),(0,o.bF)(u,{modelValue:a.experimentData.procedure,"onUpdate:modelValue":t[1]||(t[1]=e=>a.experimentData.procedure=e),label:"実験手順",required:"",rules:[e=>!!e||"実験手順は必須です"]},null,8,["modelValue","rules"]),(0,o.bF)(u,{modelValue:a.experimentData.precautions,"onUpdate:modelValue":t[2]||(t[2]=e=>a.experimentData.precautions=e),label:"注意事項"},null,8,["modelValue"]),(0,o.bF)(c,{modelValue:a.files,"onUpdate:modelValue":[t[3]||(t[3]=e=>a.files=e),a.handleFileUpload],label:"写真・PDFをアップロード",accept:"image/*,.pdf",multiple:"","show-size":"",loading:a.ocrProcessing,disabled:a.ocrProcessing,hint:"画像ファイルをアップロードしてください","persistent-hint":""},null,8,["modelValue","onUpdate:modelValue","loading","disabled"]),a.showEditor?((0,o.uX)(),(0,o.Wv)(p,{key:0,"experiment-data":a.generatedData,onSaved:a.handleSaved},null,8,["experiment-data","onSaved"])):(0,o.Q3)("",!0),a.ocrProcessing?((0,o.uX)(),(0,o.Wv)(m,{key:1,indeterminate:"",color:"primary",class:"mb-4"})):(0,o.Q3)("",!0),a.ocrResults.length>0?((0,o.uX)(),(0,o.Wv)(h,{key:2},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.ocrResults,((e,l)=>((0,o.uX)(),(0,o.Wv)(g,{key:l},{default:(0,o.k6)((()=>[(0,o.bF)(v,null,{default:(0,o.k6)((()=>[(0,o.eW)(" 文字認識結果 #"+(0,f.v_)(l+1),1)])),_:2},1024),(0,o.bF)(b,null,{default:(0,o.k6)((()=>[(0,o.bF)(u,{modelValue:a.ocrResults[l].text,"onUpdate:modelValue":e=>a.ocrResults[l].text=e,label:"抽出テキスト",hint:"テキストを編集できます","auto-grow":"",rows:"5"},null,8,["modelValue","onUpdate:modelValue"]),(0,o.bF)(k,{color:"primary",size:"small",class:"mt-2",onClick:e=>a.appendToProcedure(l)},{default:(0,o.k6)((()=>t[9]||(t[9]=[(0,o.eW)(" 手順に追加 ")]))),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})):(0,o.Q3)("",!0),(0,o.bF)(_,{class:"mt-4"},{default:(0,o.k6)((()=>[(0,o.bF)(k,{disabled:!a.valid,color:"primary",onClick:t[4]||(t[4]=e=>s.processWithGemini())},{default:(0,o.k6)((()=>t[10]||(t[10]=[(0,o.eW)(" AIでまとめる ")]))),_:1},8,["disabled"])])),_:1}),(0,o.bF)(p,{modelValue:a.showEditor,"onUpdate:modelValue":t[5]||(t[5]=e=>a.showEditor=e),"experiment-data":a.generatedData,onSaved:a.handleSaved},null,8,["modelValue","experiment-data","onSaved"])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}const M={key:0,class:"ml-4"};function O(e,t,l,n,s,r){const i=(0,o.g2)("v-spacer"),d=(0,o.g2)("v-icon"),u=(0,o.g2)("v-btn"),c=(0,o.g2)("v-card-title"),p=(0,o.g2)("v-text-field"),m=(0,o.g2)("v-col"),v=(0,o.g2)("v-textarea"),k=(0,o.g2)("v-row"),b=(0,o.g2)("v-chip"),g=(0,o.g2)("v-chip-group"),h=(0,o.g2)("v-card"),_=(0,o.g2)("v-form"),F=(0,o.g2)("v-card-text"),x=(0,o.g2)("v-card-actions"),w=(0,o.g2)("v-dialog");return(0,o.uX)(),(0,o.Wv)(w,{"model-value":l.modelValue,"onUpdate:modelValue":t[5]||(t[5]=t=>e.$emit("update:modelValue",t)),"max-width":"900px"},{default:(0,o.k6)((()=>[(0,o.bF)(h,null,{default:(0,o.k6)((()=>[(0,o.bF)(c,{class:"text-h5"},{default:(0,o.k6)((()=>[t[7]||(t[7]=(0,o.eW)(" 実験データの確認・編集 ")),(0,o.bF)(i),(0,o.bF)(u,{icon:"",onClick:n.closeDialog},{default:(0,o.k6)((()=>[(0,o.bF)(d,null,{default:(0,o.k6)((()=>t[6]||(t[6]=[(0,o.eW)("mdi-close")]))),_:1})])),_:1},8,["onClick"])])),_:1}),n.localData?((0,o.uX)(),(0,o.Wv)(F,{key:0},{default:(0,o.k6)((()=>[(0,o.bF)(_,{ref:"form"},{default:(0,o.k6)((()=>[(0,o.bF)(k,null,{default:(0,o.k6)((()=>[(0,o.bF)(m,{cols:"12",sm:"6"},{default:(0,o.k6)((()=>[(0,o.bF)(p,{modelValue:n.localData.title,"onUpdate:modelValue":t[0]||(t[0]=e=>n.localData.title=e),label:"実験タイトル",required:""},null,8,["modelValue"])])),_:1}),(0,o.bF)(m,{cols:"12",sm:"6"},{default:(0,o.k6)((()=>[(0,o.bF)(p,{modelValue:n.localData.date,"onUpdate:modelValue":t[1]||(t[1]=e=>n.localData.date=e),label:"実施日",type:"date"},null,8,["modelValue"])])),_:1}),(0,o.bF)(m,{cols:"12"},{default:(0,o.k6)((()=>[(0,o.bF)(v,{modelValue:n.localData.objective,"onUpdate:modelValue":t[2]||(t[2]=e=>n.localData.objective=e),label:"実験目的",rows:"3"},null,8,["modelValue"])])),_:1})])),_:1}),(0,o.bF)(h,{class:"mb-4 pa-4"},{default:(0,o.k6)((()=>[(0,o.bF)(c,{class:"text-h6"},{default:(0,o.k6)((()=>t[8]||(t[8]=[(0,o.eW)("実験手順")]))),_:1}),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.localData.steps,((e,l)=>((0,o.uX)(),(0,o.CE)("div",{key:l,class:"mb-4"},[(0,o.bF)(k,null,{default:(0,o.k6)((()=>[(0,o.bF)(m,{cols:"12"},{default:(0,o.k6)((()=>[(0,o.bF)(p,{modelValue:e.description,"onUpdate:modelValue":t=>e.description=t,label:`Step ${e.stepId}: 手順説明`},null,8,["modelValue","onUpdate:modelValue","label"])])),_:2},1024)])),_:2},1024),(0,o.bF)(k,{class:"ml-4"},{default:(0,o.k6)((()=>[(0,o.bF)(m,{cols:"12"},{default:(0,o.k6)((()=>[(0,o.bF)(g,{column:""},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.materials,((t,l)=>((0,o.uX)(),(0,o.Wv)(b,{key:l,closable:"","onClick:close":t=>e.materials.splice(l,1)},{default:(0,o.k6)((()=>[(0,o.eW)((0,f.v_)(t),1)])),_:2},1032,["onClick:close"])))),128))])),_:2},1024),(0,o.bF)(p,{modelValue:n.newMaterial,"onUpdate:modelValue":t[3]||(t[3]=e=>n.newMaterial=e),label:"材料を追加","append-icon":"mdi-plus","onClick:append":t=>n.addMaterial(e),onKeyup:(0,a.jR)((t=>n.addMaterial(e)),["enter"])},null,8,["modelValue","onClick:append","onKeyup"])])),_:2},1024)])),_:2},1024),e.subSteps?((0,o.uX)(),(0,o.CE)("div",M,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.subSteps,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{key:t},[(0,o.bF)(k,null,{default:(0,o.k6)((()=>[(0,o.bF)(m,{cols:"12"},{default:(0,o.k6)((()=>[(0,o.bF)(p,{modelValue:e.description,"onUpdate:modelValue":t=>e.description=t,label:`サブステップ ${e.stepId}`},null,8,["modelValue","onUpdate:modelValue","label"])])),_:2},1024)])),_:2},1024)])))),128))])):(0,o.Q3)("",!0),(0,o.bF)(p,{modelValue:e.notes,"onUpdate:modelValue":t=>e.notes=t,label:"注意点",class:"ml-4"},null,8,["modelValue","onUpdate:modelValue"])])))),128))])),_:1}),(0,o.bF)(h,{class:"mb-4 pa-4"},{default:(0,o.k6)((()=>[(0,o.bF)(c,{class:"text-h6"},{default:(0,o.k6)((()=>t[9]||(t[9]=[(0,o.eW)("注意事項")]))),_:1}),(0,o.bF)(k,null,{default:(0,o.k6)((()=>[(0,o.bF)(m,{cols:"12"},{default:(0,o.k6)((()=>[(0,o.bF)(g,{column:""},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.localData.precautions,((e,t)=>((0,o.uX)(),(0,o.Wv)(b,{key:t,closable:"","onClick:close":e=>n.localData.precautions.splice(t,1)},{default:(0,o.k6)((()=>[(0,o.eW)((0,f.v_)(e),1)])),_:2},1032,["onClick:close"])))),128))])),_:1}),(0,o.bF)(p,{modelValue:n.newPrecaution,"onUpdate:modelValue":t[4]||(t[4]=e=>n.newPrecaution=e),label:"注意事項を追加","append-icon":"mdi-plus","onClick:append":n.addPrecaution,onKeyup:(0,a.jR)(n.addPrecaution,["enter"])},null,8,["modelValue","onClick:append","onKeyup"])])),_:1})])),_:1})])),_:1})])),_:1},512)])),_:1})):(0,o.Q3)("",!0),(0,o.bF)(x,null,{default:(0,o.k6)((()=>[(0,o.bF)(i),(0,o.bF)(u,{color:"error",onClick:n.closeDialog},{default:(0,o.k6)((()=>t[10]||(t[10]=[(0,o.eW)("キャンセル")]))),_:1},8,["onClick"]),n.localData.id?n.localData.id?((0,o.uX)(),(0,o.Wv)(u,{key:1,color:"primary",onClick:n.saveEditedData},{default:(0,o.k6)((()=>t[12]||(t[12]=[(0,o.eW)("更新")]))),_:1},8,["onClick"])):(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(u,{key:0,color:"primary",onClick:n.saveExperiment},{default:(0,o.k6)((()=>t[11]||(t[11]=[(0,o.eW)("保存")]))),_:1},8,["onClick"]))])),_:1})])),_:1})])),_:1},8,["model-value"])}var N={name:"ExperimentEditor",props:{modelValue:{type:Boolean,required:!0},experimentData:{type:Object,required:!0}},emits:["update:modelValue","saved"],setup(e,{emit:t}){const l=(0,$.KR)(null),a=(0,$.KR)(""),n=(0,$.KR)("");(0,o.wB)((()=>e.experimentData),(e=>{e&&(l.value=JSON.parse(JSON.stringify(e)))}),{immediate:!0,deep:!0});const s=()=>{t("update:modelValue",!1)},r=e=>{a.value.trim()&&(e.materials.push(a.value.trim()),a.value="")},i=()=>{n.value.trim()&&(l.value.precautions.push(n.value.trim()),n.value="")},d=async()=>{try{const e=(0,h.aU)();l.value.createdAt=new Date;const a=await(0,h.gS)((0,h.rJ)(e,"experiments"),l.value);t("saved",a.id),s(),alert("実験データが保存されました")}catch(e){alert("保存中にエラーが発生しました")}},u=async()=>{try{const e=(0,h.aU)(),a=(0,h.H9)(e,"experiments",l.value.id);await(0,h.mZ)(a,{title:l.value.title,objective:l.value.objective,date:l.value.date,steps:l.value.steps,precautions:l.value.precautions,equipmentPhotos:l.value.equipmentPhotos}),t("saved",a.id),s()}catch(e){}};return{localData:l,newMaterial:a,newPrecaution:n,closeDialog:s,addMaterial:r,addPrecaution:i,saveExperiment:d,saveEditedData:u}}};const q=(0,i.A)(N,[["render",O]]);var B=q,z=l(3216);const{GoogleGenerativeAI:J}=l(4322);var Q={name:"RegisterScreen",components:{ExperimentEditor:B},data(){return{displayName:""}},created(){(0,_.hg)(C,(e=>{this.displayName=e?e.displayName:""}))},setup(){const e=(0,$.KR)(!1),t=(0,$.KR)(!1),l=(0,$.KR)(!1),a=(0,$.KR)([]),o=(0,$.KR)(!1),n=(0,$.KR)([]),s=(0,c.rd)(),r=(0,$.KR)(""),i=(0,$.Kh)({purpose:"",procedure:"",precautions:"",scheduledDate:null,notificationEnabled:!1}),d=()=>{e.value=!e.value},u=(0,$.KR)(null),p=async e=>{if(!e||!Array.isArray(e)||0===e.length)return;const t=e.filter((e=>e&&e.type&&e.type.startsWith("image/")));if(0!==t.length){o.value=!0,n.value=[];try{const e=await(0,z.createWorker)("jpn");for(const a of t)try{const t=await e.recognize(a);n.value.push({text:t.data.text,filename:a.name})}catch(l){n.value.push({text:"",error:l.message,filename:a.name})}await e.terminate()}catch(l){}finally{o.value=!1}}},m=e=>{n.value[e]&&n.value[e].text&&(i.procedure=i.procedure?`${i.procedure}\n\n${n.value[e].text}`:n.value[e].text,n.value="")},v=async()=>{if(i.procedure){l.value=!0;try{const e=(0,h.aU)();await(0,h.gS)((0,h.rJ)(e,"experiments"),{...i,generatedData:u.value,createdAt:new Date})}catch(e){}finally{l.value=!1}}},k=()=>{e.value=!1,u.value=null,s.push("/dashboard")};return{message:r,valid:t,loading:l,files:a,ocrProcessing:o,ocrResults:n,experimentData:i,generatedData:u,handleFileUpload:p,appendToProcedure:m,submitData:v,showEditor:e,handleSaved:k,toggleEditor:d}},methods:{async processWithGemini(){const e=this.experimentData;if(console.log(e),!e)return;const t=new J("AIzaSyDabHWSMe6kUQ0YOd5QrK1c8gd3Lur-nWw"),l=t.getGenerativeModel({model:"gemini-1.5-flash"}),a=12345,o=`\n      outpu JSON only(without writing \`\`\`json)\n    実験をしています．つぎのデータ簡単にまとめ，それを基に，以下のJSON Schemaのような形式でまとめて出力してください.文章に余計な空白は含めないでください.JSONは{からはじめて\`などは含まないでください.データは画像認識で文字起こしされたものであり，変な場合があるので，補正ができるならば考慮.\n\n    ${e.purpose},${e.procedure},${e.precautions}\n    {\n      "experimentId": "${a}",\n      "userId": "${this.displayName}",\n      "title": "",\n      "objective": "",\n        "date": "${this.experimentData.scheduledDate}",\n      "steps": [\n        {\n          "stepId": "1",\n          "description": "",\n          "materials": ["", "", ""],\n          "checked": false,\n          "notes": "",\n          "subSteps": [\n            {\n              "stepId": "1.1",\n              "description": "",\n              "checked": false,\n              "notes": ""\n            }\n          ]\n        },\n        {\n          "stepId": "2",\n          "description": "",\n          "materials": [""],\n          "checked": false,\n          "notes": ""\n        },\n        {\n          "stepId": "3",\n          "description": "",\n          "materials": [""],\n          "checked": false,\n          "notes": ""\n        }\n      ],\n      "precautions": [\n        "",\n        ""\n      ],\n      "equipmentPhotos": [\n        {\n          "name": "",\n          "photoUrl": ""\n        }\n      ]\n    }`;try{const e=await l.generateContent(o),t=e.response,a=t.text();try{const e=JSON.parse(a);this.generatedData=e,this.showEditor=!0}catch(n){this.message="データの形式が不正です。もう一度お試しください。"}}catch(s){this.message="データの生成中にエラーが発生しました。"}}}};const T=(0,i.A)(Q,[["render",A],["__scopeId","data-v-5edfbd9e"]]);var G=T;const H={class:"max-w-4xl mx-auto p-6"},Z={class:"text-subtitle-2"},Y={class:"mb-4 overflow-auto"},ee={class:"progress-bar-container"},te={class:"d-flex justify-space-between mb-2"},le={class:"text-subtitle-2 font-weight-medium"},ae={class:"d-flex align-center"},oe={class:"font-weight-bold"},ne={class:"text-subtitle-2"},se={key:0,class:"mt-4"},re={key:0,class:"text-center"},ie=["src","alt"],de={class:"mt-2"};function ue(e,t,l,n,s,r){const i=(0,o.g2)("v-card-title"),d=(0,o.g2)("v-card-text"),u=(0,o.g2)("v-card"),c=(0,o.g2)("v-progress-linear"),p=(0,o.g2)("v-icon"),m=(0,o.g2)("v-list-item-icon"),v=(0,o.g2)("v-list-item-title"),k=(0,o.g2)("v-list-item-content"),b=(0,o.g2)("v-list-item"),g=(0,o.g2)("v-list"),h=(0,o.g2)("v-btn"),_=(0,o.g2)("ExperimentEditor"),F=(0,o.g2)("v-checkbox"),x=(0,o.g2)("v-expansion-panel-header"),w=(0,o.g2)("v-checkbox-btn"),y=(0,o.g2)("v-list-item-subtitle"),C=(0,o.g2)("v-alert"),V=(0,o.g2)("v-card-actions"),W=(0,o.g2)("v-expansion-panel-content"),L=(0,o.g2)("v-expansion-panel"),E=(0,o.g2)("v-expansion-panels"),S=(0,o.g2)("v-spacer"),D=(0,o.g2)("v-dialog"),P=(0,o.g2)("v-row");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",H,[(0,o.bF)(u,{class:"mb-6"},{default:(0,o.k6)((()=>[(0,o.bF)(i,{class:"text-h5 overflow-auto"},{default:(0,o.k6)((()=>[(0,o.eW)((0,f.v_)(s.experiment.title)+" ",1),(0,o.Lk)("div",Z,"実施予定日: "+(0,f.v_)(s.experiment.date),1)])),_:1}),(0,o.bF)(d,null,{default:(0,o.k6)((()=>[(0,o.Lk)("div",Y,[t[6]||(t[6]=(0,o.Lk)("h3",{class:"font-weight-bold mb-2"},"実験の目的:",-1)),(0,o.Lk)("p",null,(0,f.v_)(s.experiment.objective),1)])])),_:1})])),_:1}),(0,o.Lk)("div",ee,[(0,o.Lk)("div",te,[t[7]||(t[7]=(0,o.Lk)("span",{class:"text-subtitle-2 font-weight-medium"},"進捗状況",-1)),(0,o.Lk)("span",le,(0,f.v_)(s.progressPercentage)+"%",1)]),(0,o.bF)(c,{modelValue:s.progressPercentage,"onUpdate:modelValue":t[0]||(t[0]=e=>s.progressPercentage=e),color:"primary",height:"10"},null,8,["modelValue"])]),(0,o.bF)(u,{class:"mb-6 warning-card"},{default:(0,o.k6)((()=>[(0,o.bF)(i,{class:"d-flex align-center"},{default:(0,o.k6)((()=>[(0,o.bF)(p,{color:"warning",class:"mr-2"},{default:(0,o.k6)((()=>t[8]||(t[8]=[(0,o.eW)("mdi-alert")]))),_:1}),t[9]||(t[9]=(0,o.eW)(" 注意事項 "))])),_:1}),(0,o.bF)(d,null,{default:(0,o.k6)((()=>[(0,o.bF)(g,null,{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.experiment.precautions,((e,l)=>((0,o.uX)(),(0,o.Wv)(b,{key:l},{default:(0,o.k6)((()=>[(0,o.bF)(m,null,{default:(0,o.k6)((()=>[(0,o.bF)(p,{color:"warning"},{default:(0,o.k6)((()=>t[10]||(t[10]=[(0,o.eW)("mdi-alert-circle-outline")]))),_:1})])),_:1}),(0,o.bF)(k,null,{default:(0,o.k6)((()=>[(0,o.bF)(v,{class:"overflow-auto"},{default:(0,o.k6)((()=>[(0,o.eW)((0,f.v_)(e),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1}),(0,o.bF)(h,{class:"floating-btn",color:"primary",icon:"mdi-pencil",size:"x-large",onClick:t[1]||(t[1]=e=>s.showEditor=!s.showEditor)}),(0,o.bF)(E,{class:"scrollable"},{default:(0,o.k6)((()=>[(0,o.bF)(_,{modelValue:s.showEditor,"onUpdate:modelValue":t[2]||(t[2]=e=>s.showEditor=e),"experiment-data":s.experiment,onSaved:r.loadExperiment},null,8,["modelValue","experiment-data","onSaved"]),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.experiment.steps,(e=>((0,o.uX)(),(0,o.Wv)(L,{key:e.stepId},{default:(0,o.k6)((()=>[(0,o.bF)(x,null,{default:(0,o.k6)((()=>[(0,o.Lk)("div",ae,[(0,o.bF)(F,{modelValue:e.checked,"onUpdate:modelValue":t=>e.checked=t,onChange:r.updateProgress,onClick:t[3]||(t[3]=(0,a.D$)((()=>{}),["stop"])),class:"mr-2"},null,8,["modelValue","onUpdate:modelValue","onChange"]),(0,o.Lk)("div",null,[(0,o.Lk)("div",oe,"Step "+(0,f.v_)(e.stepId),1),(0,o.Lk)("div",ne,(0,f.v_)(e.description),1)])])])),_:2},1024),(0,o.bF)(W,null,{default:(0,o.k6)((()=>[(0,o.bF)(i,{class:"text-subtitle-1 font-weight-bold"},{default:(0,o.k6)((()=>t[11]||(t[11]=[(0,o.eW)(" 必要な器具・材料: ")]))),_:1}),(0,o.bF)(d,null,{default:(0,o.k6)((()=>[(0,o.bF)(g,{style:{padding:"0"}},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.materials,((e,l)=>((0,o.uX)(),(0,o.Wv)(b,{key:l},{default:(0,o.k6)((()=>[(0,o.bF)(k,null,{default:(0,o.k6)((()=>[(0,o.bF)(v,null,{default:(0,o.k6)((()=>[(0,o.bF)(p,{style:{"font-size":"12px"}},{default:(0,o.k6)((()=>t[12]||(t[12]=[(0,o.eW)("mdi-circle")]))),_:1}),(0,o.eW)(" "+(0,f.v_)(e),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024),e.subSteps?((0,o.uX)(),(0,o.CE)("div",se,[(0,o.bF)(u,{flat:""},{default:(0,o.k6)((()=>[(0,o.bF)(i,{class:"text-subtitle-1 font-weight-bold"},{default:(0,o.k6)((()=>t[13]||(t[13]=[(0,o.eW)(" 詳細手順: ")]))),_:1}),(0,o.bF)(d,null,{default:(0,o.k6)((()=>[(0,o.bF)(g,{dense:"",justify:"center"},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.subSteps,(e=>((0,o.uX)(),(0,o.Wv)(b,{key:e.stepId},{prepend:(0,o.k6)((()=>[(0,o.bF)(w),(0,o.Lk)("span",null,[(0,o.bF)(k,null,{default:(0,o.k6)((()=>[(0,o.bF)(v,{class:"overflow-auto"},{default:(0,o.k6)((()=>[(0,o.eW)((0,f.v_)(e.stepId)+": "+(0,f.v_)(e.description),1)])),_:2},1024),e.notes?((0,o.uX)(),(0,o.Wv)(y,{key:0,class:"mt-1"},{default:(0,o.k6)((()=>[(0,o.eW)(" Note: "+(0,f.v_)(e.notes),1)])),_:2},1024)):(0,o.Q3)("",!0)])),_:2},1024)])])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)])),_:2},1024)])):(0,o.Q3)("",!0),e.notes?((0,o.uX)(),(0,o.Wv)(u,{key:1,flat:"",class:"mt-4"},{default:(0,o.k6)((()=>[(0,o.bF)(i,{class:"text-subtitle-1 font-weight-bold"},{default:(0,o.k6)((()=>t[14]||(t[14]=[(0,o.eW)(" 注意点: ")]))),_:1}),(0,o.bF)(d,null,{default:(0,o.k6)((()=>[(0,o.bF)(C,{type:"info",text:"",outlined:""},{default:(0,o.k6)((()=>[(0,o.eW)((0,f.v_)(e.notes),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)):(0,o.Q3)("",!0),(0,o.bF)(u,{flat:"",class:"mt-4"},{default:(0,o.k6)((()=>[(0,o.bF)(V,null,{default:(0,o.k6)((()=>[(0,o.bF)(h,{color:"primary",outlined:"",onClick:t=>r.capturePhoto(e.stepId)},{default:(0,o.k6)((()=>[(0,o.bF)(p,{left:""},{default:(0,o.k6)((()=>t[15]||(t[15]=[(0,o.eW)("mdi-camera")]))),_:1}),t[16]||(t[16]=(0,o.eW)(" 写真を撮影 "))])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),(0,o.bF)(D,{modelValue:s.showPhotoDialog,"onUpdate:modelValue":t[5]||(t[5]=e=>s.showPhotoDialog=e),"max-width":"500px"},{default:(0,o.k6)((()=>[(0,o.bF)(u,null,{default:(0,o.k6)((()=>[(0,o.bF)(i,null,{default:(0,o.k6)((()=>[t[18]||(t[18]=(0,o.eW)(" 写真プレビュー ")),(0,o.bF)(S),(0,o.bF)(h,{icon:"",onClick:t[4]||(t[4]=e=>s.showPhotoDialog=!1)},{default:(0,o.k6)((()=>[(0,o.bF)(p,null,{default:(0,o.k6)((()=>t[17]||(t[17]=[(0,o.eW)("mdi-close")]))),_:1})])),_:1})])),_:1}),(0,o.bF)(d,null,{default:(0,o.k6)((()=>[s.selectedPhoto?((0,o.uX)(),(0,o.CE)("div",re,[(0,o.Lk)("img",{src:s.selectedPhoto.photoUrl,class:"max-width-100",alt:s.selectedPhoto.name},null,8,ie),(0,o.Lk)("div",de,(0,f.v_)(s.selectedPhoto.name),1)])):(0,o.Q3)("",!0)])),_:1})])),_:1})])),_:1},8,["modelValue"])]),(0,o.bF)(u,{class:"action-card pa-4"},{default:(0,o.k6)((()=>[(0,o.bF)(P,{justify:"center",align:"center",class:"gap-4"},{default:(0,o.k6)((()=>[(0,o.bF)(D,{"max-width":"500"},{activator:(0,o.k6)((({props:e})=>[(0,o.bF)(h,(0,o.v6)(e,{color:"primary",size:"large",variant:"elevated",class:"action-button"}),{default:(0,o.k6)((()=>[(0,o.bF)(p,{class:"mr-2"},{default:(0,o.k6)((()=>t[19]||(t[19]=[(0,o.eW)("mdi-check-circle")]))),_:1}),t[20]||(t[20]=(0,o.eW)(" 実験を完了する "))])),_:2},1040)])),default:(0,o.k6)((({isActive:e})=>[(0,o.bF)(u,{title:"実験を完了しますか？"},{default:(0,o.k6)((()=>[(0,o.bF)(d,null,{default:(0,o.k6)((()=>t[21]||(t[21]=[(0,o.eW)(" 実験を完了してレポートに移動します."),(0,o.Lk)("br",null,null,-1),(0,o.eW)(" 100％終わっていなくてもレポートを書くことができます. ")]))),_:1}),(0,o.bF)(V,null,{default:(0,o.k6)((()=>[(0,o.bF)(S),(0,o.bF)(h,{variant:"text",onClick:t=>e.value=!1},{default:(0,o.k6)((()=>t[22]||(t[22]=[(0,o.eW)(" 閉じる ")]))),_:2},1032,["onClick"]),(0,o.bF)(h,{color:"primary",variant:"elevated",onClick:r.moveReportPage},{default:(0,o.k6)((()=>t[23]||(t[23]=[(0,o.eW)(" レポートを作成 ")]))),_:1},8,["onClick"])])),_:2},1024)])),_:2},1024)])),_:1}),(0,o.bF)(h,{color:"green-lighten-1",variant:"tonal",size:"large",class:"action-button",onClick:r.returnDashboard},{default:(0,o.k6)((()=>[(0,o.bF)(p,{class:"mr-2"},{default:(0,o.k6)((()=>t[24]||(t[24]=[(0,o.eW)("mdi-home")]))),_:1}),t[25]||(t[25]=(0,o.eW)(" 途中退室 "))])),_:1},8,["onClick"])])),_:1})])),_:1})],64)}var ce={name:"ExperimentViewer",components:{ExperimentEditor:B},data(){return{experiment:{title:"",objective:"",date:"",steps:[],precautions:[],equipmentPhotos:[],id:""},progressPercentage:0,showPhotoDialog:!1,selectedPhoto:null,showEditor:!1,showModal:!1}},async mounted(){await this.loadExperiment(),this.updateProgress()},methods:{async loadExperiment(){this.experiment.id=this.$route.params.id;try{const e=(0,h.H9)(y,"experiments",this.experiment.id),t=await(0,h.x7)(e);t.exists()&&(this.experiment={id:t.id,...t.data()})}catch(e){}},updateProgress(){const e=this.experiment.steps.length,t=this.experiment.steps.filter((e=>e.checked)).length;this.progressPercentage=Math.round(t/e*100),this.saveProgress()},async saveProgress(){try{const e=(0,h.H9)(y,"experiments",this.experiment.id);await(0,h.mZ)(e,{steps:this.experiment.steps})}catch(e){}},returnDashboard(){this.$router.push("/dashboard")},moveReportPage(){this.$router.push(`/writeReport/${this.experiment.id}`)},async capturePhoto(e){console.log(`Step ${e}の写真を撮影(未実装)`)}}};const pe=(0,i.A)(ce,[["render",ue],["__scopeId","data-v-0d61bd4c"]]);var me=pe;function ve(e,t,l,a,n,s){const r=(0,o.g2)("v-progress-circular"),i=(0,o.g2)("v-col"),d=(0,o.g2)("v-row"),u=(0,o.g2)("v-btn"),c=(0,o.g2)("v-alert"),p=(0,o.g2)("ExperimentReport"),m=(0,o.g2)("v-snackbar"),v=(0,o.g2)("v-container");return(0,o.uX)(),(0,o.Wv)(v,null,{default:(0,o.k6)((()=>[a.loading?((0,o.uX)(),(0,o.Wv)(d,{key:0,justify:"center",align:"center",style:{height:"80vh"}},{default:(0,o.k6)((()=>[(0,o.bF)(i,{cols:"12",class:"text-center"},{default:(0,o.k6)((()=>[(0,o.bF)(r,{indeterminate:"",color:"primary",size:"64"}),t[1]||(t[1]=(0,o.Lk)("div",{class:"mt-4"},"実験データを読み込んでいます...",-1))])),_:1})])),_:1})):a.error?((0,o.uX)(),(0,o.Wv)(d,{key:1,justify:"center",align:"center",style:{height:"80vh"}},{default:(0,o.k6)((()=>[(0,o.bF)(i,{cols:"12",class:"text-center"},{default:(0,o.k6)((()=>[(0,o.bF)(c,{type:"error",title:"エラーが発生しました"},{append:(0,o.k6)((()=>[(0,o.bF)(u,{color:"error",onClick:a.loadExperiment},{default:(0,o.k6)((()=>t[2]||(t[2]=[(0,o.eW)("再試行")]))),_:1},8,["onClick"])])),default:(0,o.k6)((()=>[(0,o.eW)((0,f.v_)(a.error)+" ",1)])),_:1})])),_:1})])),_:1})):a.experimentData?((0,o.uX)(),(0,o.CE)(o.FK,{key:3},[(0,o.bF)(d,{class:"mb-4"},{default:(0,o.k6)((()=>[(0,o.bF)(i,{cols:"12"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{icon:"mdi-arrow-left",variant:"text",onClick:a.goBack},null,8,["onClick"]),t[5]||(t[5]=(0,o.Lk)("span",{class:"text-h5 ml-2"},"レポート作成",-1))])),_:1})])),_:1}),(0,o.bF)(p,{"experiment-data":a.experimentData,onSaved:a.handleReportSaved},null,8,["experiment-data","onSaved"])],64)):((0,o.uX)(),(0,o.Wv)(d,{key:2,justify:"center",align:"center",style:{height:"80vh"}},{default:(0,o.k6)((()=>[(0,o.bF)(i,{cols:"12",class:"text-center"},{default:(0,o.k6)((()=>[(0,o.bF)(c,{type:"warning",title:"実験データが見つかりません"},{append:(0,o.k6)((()=>[(0,o.bF)(u,{color:"primary",onClick:a.goBack},{default:(0,o.k6)((()=>t[3]||(t[3]=[(0,o.eW)("戻る")]))),_:1},8,["onClick"])])),default:(0,o.k6)((()=>[t[4]||(t[4]=(0,o.eW)(" 指定された実験データが見つかりませんでした。 "))])),_:1})])),_:1})])),_:1})),(0,o.bF)(m,{modelValue:a.showSuccessSnackbar,"onUpdate:modelValue":t[0]||(t[0]=e=>a.showSuccessSnackbar=e),color:"success",timeout:"3000"},{default:(0,o.k6)((()=>t[6]||(t[6]=[(0,o.eW)(" レポートを保存しました ")]))),_:1},8,["modelValue"])])),_:1})}const ke={class:"mb-4"},fe={class:"mb-4"},be={class:"mb-4"},ge={class:"mb-4"},he={key:0,class:"mt-4"};function _e(e,t,l,a,n,s){const r=(0,o.g2)("v-spacer"),i=(0,o.g2)("v-btn"),d=(0,o.g2)("v-card-title"),u=(0,o.g2)("v-icon"),c=(0,o.g2)("v-list-item"),p=(0,o.g2)("v-list"),m=(0,o.g2)("v-card-text"),v=(0,o.g2)("v-card"),k=(0,o.g2)("v-col"),b=(0,o.g2)("v-text-field"),g=(0,o.g2)("v-tab"),h=(0,o.g2)("v-tabs"),_=(0,o.g2)("v-textarea"),F=(0,o.g2)("v-window-item"),x=(0,o.g2)("v-file-input"),w=(0,o.g2)("v-img"),y=(0,o.g2)("v-window"),C=(0,o.g2)("v-form"),V=(0,o.g2)("ExperimentEditor"),W=(0,o.g2)("v-row"),L=(0,o.g2)("v-container");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(L,null,{default:(0,o.k6)((()=>[(0,o.bF)(W,null,{default:(0,o.k6)((()=>[(0,o.bF)(k,{cols:"12"},{default:(0,o.k6)((()=>[(0,o.bF)(v,{class:"mb-4"},{default:(0,o.k6)((()=>[(0,o.bF)(d,{class:"text-h5"},{default:(0,o.k6)((()=>[t[10]||(t[10]=(0,o.eW)(" 実験レポート作成 ")),(0,o.bF)(r),(0,o.bF)(i,{color:"primary",onClick:a.saveReport,loading:a.saving},{default:(0,o.k6)((()=>t[9]||(t[9]=[(0,o.eW)(" 保存 ")]))),_:1},8,["onClick","loading"])])),_:1}),(0,o.bF)(m,null,{default:(0,o.k6)((()=>[(0,o.bF)(W,null,{default:(0,o.k6)((()=>[(0,o.bF)(k,{cols:"12",md:"4"},{default:(0,o.k6)((()=>[(0,o.bF)(v,{variant:"outlined"},{default:(0,o.k6)((()=>[(0,o.bF)(d,{class:"text-h6"},{default:(0,o.k6)((()=>t[11]||(t[11]=[(0,o.eW)("実験データ")]))),_:1}),(0,o.bF)(m,null,{default:(0,o.k6)((()=>[(0,o.Lk)("div",ke,[t[12]||(t[12]=(0,o.Lk)("strong",null,"実験タイトル:",-1)),(0,o.eW)(" "+(0,f.v_)(l.experimentData.title),1)]),(0,o.Lk)("div",fe,[t[13]||(t[13]=(0,o.Lk)("strong",null,"実施日:",-1)),(0,o.eW)(" "+(0,f.v_)(l.experimentData.date),1)]),(0,o.Lk)("div",be,[t[14]||(t[14]=(0,o.Lk)("strong",null,"実験目的:",-1)),(0,o.Lk)("p",null,(0,f.v_)(l.experimentData.objective),1)]),(0,o.Lk)("div",ge,[t[17]||(t[17]=(0,o.Lk)("strong",null,"実験手順:",-1)),(0,o.bF)(p,{density:"compact"},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(l.experimentData.steps,(e=>((0,o.uX)(),(0,o.Wv)(c,{key:e.stepId},{title:(0,o.k6)((()=>[e.checked?((0,o.uX)(),(0,o.Wv)(u,{key:0,color:"primary",class:"mr-2"},{default:(0,o.k6)((()=>t[15]||(t[15]=[(0,o.eW)("mdi-check")]))),_:1})):((0,o.uX)(),(0,o.Wv)(u,{key:1,color:"red",class:"mr-2"},{default:(0,o.k6)((()=>t[16]||(t[16]=[(0,o.eW)("mdi-flask-empty-off-outline")]))),_:1})),(0,o.eW)(" Step "+(0,f.v_)(e.stepId),1)])),subtitle:(0,o.k6)((()=>[(0,o.eW)((0,f.v_)(e.description),1)])),_:2},1024)))),128))])),_:1})])])),_:1})])),_:1})])),_:1}),(0,o.bF)(k,{cols:"12",md:"8"},{default:(0,o.k6)((()=>[(0,o.bF)(C,{ref:"form"},{default:(0,o.k6)((()=>[(0,o.bF)(b,{modelValue:a.report.title,"onUpdate:modelValue":t[0]||(t[0]=e=>a.report.title=e),label:"レポートタイトル",required:"",class:"mb-4"},null,8,["modelValue"]),(0,o.bF)(h,{modelValue:a.activeTab,"onUpdate:modelValue":t[1]||(t[1]=e=>a.activeTab=e),class:"mb-4"},{default:(0,o.k6)((()=>[(0,o.bF)(g,{value:"abstract"},{default:(0,o.k6)((()=>t[18]||(t[18]=[(0,o.eW)("要約")]))),_:1}),(0,o.bF)(g,{value:"method"},{default:(0,o.k6)((()=>t[19]||(t[19]=[(0,o.eW)("実験方法")]))),_:1}),(0,o.bF)(g,{value:"result"},{default:(0,o.k6)((()=>t[20]||(t[20]=[(0,o.eW)("実験結果")]))),_:1}),(0,o.bF)(g,{value:"discussion"},{default:(0,o.k6)((()=>t[21]||(t[21]=[(0,o.eW)("考察")]))),_:1})])),_:1},8,["modelValue"]),(0,o.bF)(y,{modelValue:a.activeTab,"onUpdate:modelValue":t[7]||(t[7]=e=>a.activeTab=e)},{default:(0,o.k6)((()=>[(0,o.bF)(F,{value:"abstract"},{default:(0,o.k6)((()=>[(0,o.bF)(_,{modelValue:a.report.abstract,"onUpdate:modelValue":t[2]||(t[2]=e=>a.report.abstract=e),label:"要約",rows:"6",hint:"実験の目的、方法、結果、結論を簡潔に記述してください","persistent-hint":""},null,8,["modelValue"])])),_:1}),(0,o.bF)(F,{value:"method"},{default:(0,o.k6)((()=>[(0,o.bF)(_,{modelValue:a.report.method,"onUpdate:modelValue":t[3]||(t[3]=e=>a.report.method=e),label:"実験方法",rows:"10",hint:"使用した機器、材料、手順を詳細に記述してください","persistent-hint":""},null,8,["modelValue"])])),_:1}),(0,o.bF)(F,{value:"result"},{default:(0,o.k6)((()=>[(0,o.bF)(_,{modelValue:a.report.result,"onUpdate:modelValue":t[4]||(t[4]=e=>a.report.result=e),label:"実験結果",rows:"10",hint:"測定値、観察結果、データ分析結果を記述してください","persistent-hint":""},null,8,["modelValue"]),(0,o.bF)(x,{modelValue:a.resultFiles,"onUpdate:modelValue":t[5]||(t[5]=e=>a.resultFiles=e),label:"結果の図表を添付",multiple:"",accept:"image/*","prepend-icon":"mdi-camera",class:"mt-4",onChange:a.handleFileUpload},null,8,["modelValue","onChange"]),a.report.figures.length>0?((0,o.uX)(),(0,o.CE)("div",he,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.report.figures,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{key:t,class:"mb-2"},[(0,o.bF)(w,{src:e.url,"max-height":"200"},null,8,["src"]),(0,o.bF)(b,{modelValue:e.caption,"onUpdate:modelValue":t=>e.caption=t,label:`図${t+1}のキャプション`,dense:""},null,8,["modelValue","onUpdate:modelValue","label"])])))),128))])):(0,o.Q3)("",!0)])),_:1}),(0,o.bF)(F,{value:"discussion"},{default:(0,o.k6)((()=>[(0,o.bF)(_,{modelValue:a.report.discussion,"onUpdate:modelValue":t[6]||(t[6]=e=>a.report.discussion=e),label:"考察",rows:"10",hint:"結果の解釈、課題、今後の展望について記述してください","persistent-hint":""},null,8,["modelValue"])])),_:1})])),_:1},8,["modelValue"])])),_:1},512),(0,o.bF)(i,{loading:!a.valid,color:"primary",onClick:a.processWithGemini},{default:(0,o.k6)((()=>t[22]||(t[22]=[(0,o.eW)(" AIでまとめる ")]))),_:1},8,["loading","onClick"]),a.showEditor?((0,o.uX)(),(0,o.Wv)(V,{key:0,"experiment-data":a.generatedData,onSaved:a.handleSaved},null,8,["experiment-data","onSaved"])):(0,o.Q3)("",!0),(0,o.bF)(V,{modelValue:a.showEditor,"onUpdate:modelValue":t[8]||(t[8]=e=>a.showEditor=e),"experiment-data":a.generatedData,onSaved:a.handleSaved},null,8,["modelValue","experiment-data","onSaved"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,o.bF)(i,{class:"floating-btn",color:"primary",icon:"mdi-home",size:"x-large",onClick:a.returnDashboard},null,8,["onClick"])],64)}const{GoogleGenerativeAI:Fe}=l(4322);var xe={name:"ExperimentReport",props:{experimentData:{type:Object,required:!0}},setup(e){const t=(0,$.KR)(!0),l=(0,$.KR)(!1),a=(0,c.lq)(),n=(0,c.rd)(),s=(0,$.KR)(null),r=(0,$.KR)("abstract"),i=(0,$.KR)(!1),d=(0,$.KR)([]);let u=null;const p=()=>{l.value=!l.value},m=(0,$.KR)({title:"",abstract:"",method:"",result:"",discussion:"",figures:[],experimentId:a.params.id,createdAt:null,updatedAt:null});(0,o.sV)((async()=>{const e=(0,h.aU)(),t=(0,h.H9)(e,"reports",a.params.id),l=await(0,h.x7)(t);if(l.exists()){const e=l.data();m.value={...m.value,...e}}}));const v=async e=>{if(!e)return;const t=(0,F.c7)();for(const l of e){const e=(0,F.KR)(t,`reports/${a.params.id}/${l.name}`);await(0,F.D)(e,l);const o=await(0,F.qk)(e);m.value.figures.push({url:o,caption:"",filename:l.name})}},k=async()=>{try{i.value=!0;const e=(0,h.aU)(),t=(0,h.H9)(e,"reports",a.params.id),l=new Date;m.value.updatedAt=l,m.value.createdAt||(m.value.createdAt=l),await(0,h.BN)(t,m.value),i.value=!1,alert("レポートを保存しました")}catch(e){alert("保存中にエラーが発生しました"),i.value=!1}},f=()=>{n.push("/dashboard")},b=async()=>{t.value=!1;const l=e.experimentData;if(!l)return;const a=new Fe("AIzaSyDabHWSMe6kUQ0YOd5QrK1c8gd3Lur-nWw"),o=a.getGenerativeModel({model:"gemini-1.5-flash"}),n=`output JSON only (without writing \`\`\`json)\n  実験をしています．次のデータの内容をより分かりやすくまとめてください．それを基に，以下のJSON Schemaのような形式でまとめて出力してください。文章に余計な空白は含めないでください。JSONは { からはじめて \` などは含まないでください。データは画像認識で文字起こしされたものであり，変な場合があるので，補正ができるならば考慮してください。\n\n  実験スキーマ：${l.date}, ${l.objective}, ${l.precautions}, ${l.steps}, ${l.title}\n  ノート: ${m.value.title}, ${m.value.abstract}, ${m.value.method}, ${m.value.result}, ${m.value.discussion}, ${JSON.stringify(m.value.figures)}\n\n  項目が空白の場合は，補完やヒントを書いて出力すること(その場合はヒントであることを明示せよ)。\n  {\n    "title": "${m.value.title||""}",\n    "abstract": "${m.value.abstract||""}",\n    "method": "${m.value.method||""}",\n    "result": "${m.value.result||""}",\n    "discussion": "${m.value.discussion||""}",\n    "figures": ${JSON.stringify(m.value.figures)||"[]"},\n    "experimentId": "${m.value.experimentId}",\n    "createdAt": "${m.value.createdAt||null}",\n    "updatedAt": "${m.value.updatedAt||null}"\n  }`;alert();try{const e=await o.generateContent(n),t=e.response,l=t.text();try{const e=JSON.parse(l);m.value=e}catch(s){alert("データの形式が不正です。もう一度お試しください。")}}catch(r){alert("データの生成中にエラーが発生しました。")}t.value=!0},g=()=>{l.value=!1,u.value=null,n.push("/dashboard")};return{showEditor:l,generatedData:u,toggleEditor:p,props:e,form:s,report:m,activeTab:r,saving:i,resultFiles:d,handleFileUpload:v,saveReport:k,returnDashboard:f,processWithGemini:b,handleSaved:g,valid:t}}};const we=(0,i.A)(xe,[["render",_e],["__scopeId","data-v-4ea1e055"]]);var ye=we,Ce={name:"WriteReportScreen",components:{ExperimentReport:ye},setup(){const e=(0,c.lq)(),t=(0,c.rd)(),l=(0,$.KR)(null),a=(0,$.KR)(!0),n=(0,$.KR)(null),s=(0,$.KR)(!1),r=async()=>{a.value=!0,n.value=null;try{const t=e.params.id;if(!t)throw new Error("実験IDが指定されていません");const a=(0,h.aU)(),o=(0,h.H9)(a,"experiments",t),n=await(0,h.x7)(o);if(!n.exists())throw new Error("実験データが見つかりません");l.value={id:n.id,...n.data()}}catch(o){n.value=o.message||"実験データの読み込み中にエラーが発生しました",t.push(`/experiment/${e.params.id}`)}finally{a.value=!1}},i=()=>{t.push(`/experiment/${e.params.id}`)},d=()=>{s.value=!0,setTimeout((()=>{t.push("/dashboard")}),3e3)};return(0,o.sV)((()=>{r()})),{experimentData:l,loading:a,error:n,showSuccessSnackbar:s,loadExperiment:r,goBack:i,handleReportSaved:d}}};const Ve=(0,i.A)(Ce,[["render",ve]]);var We=Ve;const Le=[{path:"/",name:"Start",component:k},{path:"/login",name:"Login",component:L},{path:"/signup",name:"Signup",component:P},{path:"/dashboard",name:"Dashboard",component:j},{path:"/register",name:"Register",component:G},{path:"/experiment/:id",name:"Experiment",component:me,props:!0},{path:"/writeReport/:id",name:"Report",component:We,props:!0}],Ee=(0,c.aE)({history:(0,c.LA)("/jikkenTodo/"),routes:Le});var Se=Ee,De=(l(5524),l(7768)),Pe=l(1920),Ue=l(5741),Re=l(8221),Xe=(0,De.$N)({components:Pe,directives:Ue,icons:{defaultSet:"mdi",aliases:Re.z,sets:{mdi:Re.r}},theme:{defaultTheme:"light"},defaults:{VDialog:{scrollable:!0,VCard:{elevation:0}}}}),$e=l(4373),Ke=l(6942);function Ie(e,t,l,a,n,s){const r=(0,o.g2)("v-card-text"),i=(0,o.g2)("v-spacer"),d=(0,o.g2)("v-btn"),u=(0,o.g2)("v-card-actions"),c=(0,o.g2)("v-card"),p=(0,o.g2)("v-dialog");return(0,o.uX)(),(0,o.Wv)(p,{modelValue:a.isActive,"onUpdate:modelValue":t[0]||(t[0]=e=>a.isActive=e),"max-width":"400"},{default:(0,o.k6)((()=>[(0,o.bF)(c,null,{default:(0,o.k6)((()=>[(0,o.bF)(r,null,{default:(0,o.k6)((()=>[(0,o.eW)((0,f.v_)(l.message),1)])),_:1}),(0,o.bF)(u,null,{default:(0,o.k6)((()=>[(0,o.bF)(i),(0,o.bF)(d,{variant:"text",onClick:a.closeDialog},{default:(0,o.k6)((()=>t[1]||(t[1]=[(0,o.eW)(" 閉じる ")]))),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])}var je={name:"MessageDialog",props:{message:{type:String,default:""},show:{type:Boolean,default:!1}},setup(e,{emit:t}){const l=(0,$.KR)(e.show);(0,o.wB)((()=>e.message),(e=>{e&&(l.value=!0)}));const a=()=>{l.value=!1,t("update:show",!1)};return(0,o.wB)((()=>e.show),(e=>{l.value=e})),{isActive:l,closeDialog:a}}};const Ae=(0,i.A)(je,[["render",Ie]]);var Me=Ae;const Oe=(0,a.Ef)(u);Oe.use(Se),Oe.use(Xe),Oe.use(Ke.A),Oe.use($e.A),Oe.use("MessageDialog",Me),Oe.mount("#app")}},t={};function l(a){var o=t[a];if(void 0!==o)return o.exports;var n=t[a]={id:a,loaded:!1,exports:{}};return e[a].call(n.exports,n,n.exports,l),n.loaded=!0,n.exports}l.m=e,function(){l.amdO={}}(),function(){var e=[];l.O=function(t,a,o,n){if(!a){var s=1/0;for(u=0;u<e.length;u++){a=e[u][0],o=e[u][1],n=e[u][2];for(var r=!0,i=0;i<a.length;i++)(!1&n||s>=n)&&Object.keys(l.O).every((function(e){return l.O[e](a[i])}))?a.splice(i--,1):(r=!1,n<s&&(s=n));if(r){e.splice(u--,1);var d=o();void 0!==d&&(t=d)}}return t}n=n||0;for(var u=e.length;u>0&&e[u-1][2]>n;u--)e[u]=e[u-1];e[u]=[a,o,n]}}(),function(){l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,{a:t}),t}}(),function(){l.d=function(e,t){for(var a in t)l.o(t,a)&&!l.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){l.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){l.hmd=function(e){return e=Object.create(e),e.children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e}}(),function(){l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};l.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,n,s=a[0],r=a[1],i=a[2],d=0;if(s.some((function(t){return 0!==e[t]}))){for(o in r)l.o(r,o)&&(l.m[o]=r[o]);if(i)var u=i(l)}for(t&&t(a);d<s.length;d++)n=s[d],l.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return l.O(u)},a=self["webpackChunkjikken_todo_app"]=self["webpackChunkjikken_todo_app"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=l.O(void 0,[504],(function(){return l(6341)}));a=l.O(a)})();
//# sourceMappingURL=app.d153c2c0.js.map